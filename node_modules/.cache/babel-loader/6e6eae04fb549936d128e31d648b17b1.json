{"ast":null,"code":"var _jsxFileName = \"/home/joaohgs/Documents/ProjetosReact/cdc-admin/src/components/Livros.js\";\nimport $ from \"jquery\";\nimport InputCustomizado from \"./InputCustomizado\";\nimport React, { Component } from 'react';\nimport PubSub from 'pubsub-js';\nimport TratadorErros from './TratadorErros';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass FormularioLivro extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      titulo: '',\n      preco: '',\n      autorId: ''\n    };\n    this.setTitulo = this.setTitulo.bind(this);\n    this.setPreco = this.setPreco.bind(this);\n    this.setAutorId = this.setAutorId.bind(this);\n    this.handleLivroSubmit = this.handleLivroSubmit.bind(this);\n  }\n\n  setTitulo(e) {\n    this.setState({\n      titulo: e.target.value\n    });\n  }\n\n  setPreco(e) {\n    this.setState({\n      preco: e.target.value\n    });\n  }\n\n  setAutorId(e) {\n    this.setState({\n      autorId: e.target.value\n    });\n  }\n\n  handleLivroSubmit(e) {\n    e.preventDefault();\n    var titulo = this.state.titulo.trim();\n    var preco = this.state.preco.trim();\n    var autorId = this.state.autorId;\n    $.ajax({\n      url: 'https://cdc-react.herokuapp.com/api/livros',\n      contentType: 'application/json',\n      dataType: 'json',\n      type: 'POST',\n      data: JSON.stringify({\n        titulo: titulo,\n        preco: preco,\n        autorId: autorId\n      }),\n      success: function (novaListagem) {\n        PubSub.publish('atualiza-lista-livros', novaListagem);\n        this.setState({\n          titulo: '',\n          preco: '',\n          autorId: ''\n        });\n      },\n      error: function (resposta) {\n        if (resposta.status === 400) {\n          new TratadorErros().publicaErros(resposta.responseJSON);\n        }\n      },\n      beforeSend: function () {\n        PubSub.publish(\"limpa-erros\", {});\n      }\n    });\n    this.setState({\n      titulo: '',\n      preco: '',\n      autorId: ''\n    });\n  }\n\n  render() {\n    var autores = this.props.autores.map(function (autor) {\n      return /*#__PURE__*/_jsxDEV(\"option\", {\n        value: autor.id,\n        children: autor.nome\n      }, autor.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 14\n      }, this);\n    });\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"autorForm\",\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        className: \"pure-form pure-form-aligned\",\n        onSubmit: this.handleLivroSubmit,\n        children: [/*#__PURE__*/_jsxDEV(InputCustomizado, {\n          id: \"titulo\",\n          name: \"titulo\",\n          label: \"Titulo: \",\n          type: \"text\",\n          value: this.state.titulo,\n          placeholder: \"Titulo do livro\",\n          onChange: this.setTitulo\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(InputCustomizado, {\n          id: \"preco\",\n          name: \"preco\",\n          label: \"Preco: \",\n          type: \"decimal\",\n          value: this.state.preco,\n          placeholder: \"Pre\\xE7o do livro\",\n          onChange: this.setPreco\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"pure-controls\",\n          children: /*#__PURE__*/_jsxDEV(\"select\", {\n            value: this.state.autorId,\n            name: \"autorId\",\n            onChange: this.setAutorId,\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"\",\n              children: \"Selecione\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 70,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"script\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 71,\n              columnNumber: 16\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 69,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"pure-control-group\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 77,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            className: \"pure-button pure-button-primary\",\n            children: \"Gravar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 78,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nclass TabelaLivros extends Component {\n  render() {\n    var livros = this.props.lista.map(function (livro) {\n      return /*#__PURE__*/_jsxDEV(\"tr\", {\n        children: [/*#__PURE__*/_jsxDEV(\"td\", {\n          children: livro.titulo\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n          children: livro.autor.nome\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n          children: livro.preco\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 13\n        }, this)]\n      }, livro.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 11\n      }, this);\n    });\n    return /*#__PURE__*/_jsxDEV(\"table\", {\n      className: \"pure-table\",\n      children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n        children: /*#__PURE__*/_jsxDEV(\"tr\", {\n          children: [/*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Titulo\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Autor\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 103,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Preco\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 104,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n        children: livros\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default class LivroAdmin extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      lista: [],\n      autores: []\n    };\n  }\n\n  componentDidMount() {\n    $.ajax({\n      url: \"https://cdc-react.herokuapp.com/api/livros\",\n      dataType: 'json',\n      success: function (data) {\n        this.setState({\n          lista: data\n        });\n      }.bind(this)\n    });\n    $.ajax({\n      url: \"https://cdc-react.herokuapp.com/api/autores\",\n      dataType: 'json',\n      success: function (data) {\n        console.log(data);\n        autoresNome = [];\n        i = 0;\n\n        while (i < autores.length) {\n          autoresNome += data[i].titulo;\n          i++;\n        }\n\n        this.setState({\n          autores: data\n        });\n      }.bind(this)\n    });\n    PubSub.subscribe('atualiza-lista-livros', function (topicName, lista) {\n      this.setState({\n        lista: lista\n      });\n    }.bind(this));\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"header\",\n        children: /*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"Cadastro de Livros\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"content\",\n        id: \"content\",\n        children: [/*#__PURE__*/_jsxDEV(FormularioLivro, {\n          autores: this.state.autores\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(TabelaLivros, {\n          lista: this.state.lista\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 7\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["/home/joaohgs/Documents/ProjetosReact/cdc-admin/src/components/Livros.js"],"names":["$","InputCustomizado","React","Component","PubSub","TratadorErros","FormularioLivro","constructor","props","state","titulo","preco","autorId","setTitulo","bind","setPreco","setAutorId","handleLivroSubmit","e","setState","target","value","preventDefault","trim","ajax","url","contentType","dataType","type","data","JSON","stringify","success","novaListagem","publish","error","resposta","status","publicaErros","responseJSON","beforeSend","render","autores","map","autor","id","nome","TabelaLivros","livros","lista","livro","LivroAdmin","componentDidMount","console","log","autoresNome","i","length","subscribe","topicName"],"mappings":"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","sourcesContent":["import $ from \"jquery\";\nimport InputCustomizado from \"./InputCustomizado\"\nimport React, { Component } from 'react';\nimport PubSub from 'pubsub-js';\nimport TratadorErros from './TratadorErros'\n\nclass FormularioLivro extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {titulo: '', preco: '', autorId: ''};\n    this.setTitulo = this.setTitulo.bind(this);\n    this.setPreco = this.setPreco.bind(this);\n    this.setAutorId = this.setAutorId.bind(this);   \n    this.handleLivroSubmit = this.handleLivroSubmit.bind(this);\n  }\n\n  setTitulo(e) {\n    this.setState({titulo: e.target.value});\n  }\n\n  setPreco(e) {\n    this.setState({preco: e.target.value});\n  }\n\n  setAutorId(e) {\n    this.setState({autorId: e.target.value});\n  }\n\n\n  handleLivroSubmit(e) {\n    e.preventDefault();\n    var titulo = this.state.titulo.trim();\n    var preco = this.state.preco.trim();\n    var autorId = this.state.autorId;\n\n    $.ajax({\n      url: 'https://cdc-react.herokuapp.com/api/livros',\n      contentType: 'application/json',\n      dataType: 'json',\n      type: 'POST',\n      data: JSON.stringify({titulo:titulo,preco:preco,autorId:autorId}),\n      success: function(novaListagem) {\n          PubSub.publish( 'atualiza-lista-livros',novaListagem);            \n          this.setState({titulo:'',preco:'',autorId:''});\n      },\n      error: function(resposta){\n        if(resposta.status === 400){\n          new TratadorErros().publicaErros(resposta.responseJSON);\n        }\n      },\n      beforeSend: function(){\n        PubSub.publish(\"limpa-erros\",{});\n      }            \n    });  \n\n    this.setState({titulo: '', preco: '', autorId: ''});\n  }\n\n  render() {\n    var autores = this.props.autores.map(function(autor){\n      return <option key={autor.id} value={autor.id}>{autor.nome}</option>;\n    });\n    return (\n      <div className=\"autorForm\">\n        <form className=\"pure-form pure-form-aligned\" onSubmit={this.handleLivroSubmit}>\n          <InputCustomizado id=\"titulo\" name=\"titulo\" label=\"Titulo: \" type=\"text\" value={this.state.titulo} placeholder=\"Titulo do livro\" onChange={this.setTitulo} />\n          <InputCustomizado id=\"preco\" name=\"preco\" label=\"Preco: \" type=\"decimal\" value={this.state.preco} placeholder=\"PreÃ§o do livro\" onChange={this.setPreco} />\n          <div className=\"pure-controls\">\n            <select value={this.state.autorId} name=\"autorId\" onChange={this.setAutorId}>\n              <option value=\"\">Selecione</option>\n              {<script>\n                \n              </script>}\n            </select>\n          </div>\n          <div className=\"pure-control-group\">                                  \n            <label></label> \n            <button type=\"submit\" className=\"pure-button pure-button-primary\">Gravar</button>                                    \n          </div>\n        </form>\n      </div>\n    );\n  }\n} \n\nclass TabelaLivros extends Component {\n\n  render() {\n    var livros = this.props.lista.map(function(livro){\n      return(\n          <tr key={livro.id}>\n            <td>{livro.titulo}</td>\n            <td>{livro.autor.nome}</td>\n            <td>{livro.preco}</td>\n          </tr>\n        );\n      });\n    return(\n      <table className=\"pure-table\">\n        <thead>\n          <tr>\n            <th>Titulo</th>\n            <th>Autor</th>\n            <th>Preco</th>\n          </tr>\n        </thead>\n        <tbody>\n          {livros}\n        </tbody>\n      </table>\n    );\n  }\n}\n\nexport default class LivroAdmin extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {lista : [],autores:[]};\n  }\n\n  componentDidMount() {\n    $.ajax({\n      url: \"https://cdc-react.herokuapp.com/api/livros\",\n      dataType: 'json',\n      success: function(data) {\n        this.setState({lista: data});\n      }.bind(this)\n    });\n\n    $.ajax({\n      url: \"https://cdc-react.herokuapp.com/api/autores\",\n      dataType: 'json',\n      success: function(data) {\n        console.log(data);\n        autoresNome = []\n        i=0;\n          while(i < autores.length){\n            autoresNome += data[i].titulo;\n            i++;\n          }\n        this.setState({autores: data});\n      }.bind(this)\n    });\n\n    PubSub.subscribe('atualiza-lista-livros', function(topicName,lista){\n      this.setState({lista:lista});\n    }.bind(this));\n  }\n\n  render() {\n    return(\n      <div>\n        <div className=\"header\">\n          <h1>Cadastro de Livros</h1>\n        </div>\n        <div className=\"content\" id=\"content\">\n          <FormularioLivro autores={this.state.autores}/>\n          <TabelaLivros lista={this.state.lista}/>\n        </div>\n      </div>\n    );\n  }\n}"]},"metadata":{},"sourceType":"module"}