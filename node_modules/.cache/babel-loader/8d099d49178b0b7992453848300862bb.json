{"ast":null,"code":"import _classCallCheck from\"/home/joaohgs/Documents/ProjetosReact/cdc-admin/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/joaohgs/Documents/ProjetosReact/cdc-admin/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/joaohgs/Documents/ProjetosReact/cdc-admin/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/joaohgs/Documents/ProjetosReact/cdc-admin/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/joaohgs/Documents/ProjetosReact/cdc-admin/node_modules/@babel/runtime/helpers/esm/createSuper\";import $ from\"jquery\";import InputCustomizado from\"./InputCustomizado\";import React,{Component}from'react';import PubSub from'pubsub-js';import TratadorErros from'./TratadorErros';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var FormularioLivro=/*#__PURE__*/function(_Component){_inherits(FormularioLivro,_Component);var _super=_createSuper(FormularioLivro);function FormularioLivro(props){var _this;_classCallCheck(this,FormularioLivro);_this=_super.call(this,props);_this.state={titulo:'',preco:'',autorId:''};_this.setTitulo=_this.setTitulo.bind(_assertThisInitialized(_this));_this.setPreco=_this.setPreco.bind(_assertThisInitialized(_this));_this.setAutorId=_this.setAutorId.bind(_assertThisInitialized(_this));_this.handleLivroSubmit=_this.handleLivroSubmit.bind(_assertThisInitialized(_this));return _this;}_createClass(FormularioLivro,[{key:\"setTitulo\",value:function setTitulo(e){this.setState({titulo:e.target.value});}},{key:\"setPreco\",value:function setPreco(e){this.setState({preco:e.target.value});}},{key:\"setAutorId\",value:function setAutorId(e){this.setState({autorId:e.target.value});}},{key:\"handleLivroSubmit\",value:function handleLivroSubmit(e){e.preventDefault();var titulo=this.state.titulo.trim();var preco=this.state.preco.trim();var autorId=this.state.autorId;$.ajax({url:'https://cdc-react.herokuapp.com/api/livros',contentType:'application/json',dataType:'json',type:'POST',data:JSON.stringify({titulo:titulo,preco:preco,autorId:autorId}),success:function success(novaListagem){PubSub.publish('atualiza-lista-livros',novaListagem);this.setState({titulo:'',preco:'',autorId:''});},error:function error(resposta){if(resposta.status===400){new TratadorErros().publicaErros(resposta.responseJSON);}},beforeSend:function beforeSend(){PubSub.publish(\"limpa-erros\",{});}});this.setState({titulo:'',preco:'',autorId:''});}},{key:\"render\",value:function render(){var autores=this.props.autores.map(function(autor){return/*#__PURE__*/_jsx(\"option\",{value:autor.id,children:autor.nome},autor.id);});return/*#__PURE__*/_jsx(\"div\",{className:\"autorForm\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"pure-form pure-form-aligned\",onSubmit:this.handleLivroSubmit,children:[/*#__PURE__*/_jsx(InputCustomizado,{id:\"titulo\",name:\"titulo\",label:\"Titulo: \",type:\"text\",value:this.state.titulo,placeholder:\"Titulo do livro\",onChange:this.setTitulo}),/*#__PURE__*/_jsx(InputCustomizado,{id:\"preco\",name:\"preco\",label:\"Preco: \",type:\"decimal\",value:this.state.preco,placeholder:\"Pre\\xE7o do livro\",onChange:this.setPreco}),/*#__PURE__*/_jsx(\"div\",{className:\"pure-controls\",children:/*#__PURE__*/_jsxs(\"select\",{value:this.state.autorId,name:\"autorId\",onChange:this.setAutorId,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Selecione\"}),autores]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"pure-control-group\",children:[/*#__PURE__*/_jsx(\"label\",{}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"pure-button pure-button-primary\",children:\"Gravar\"})]})]})});}}]);return FormularioLivro;}(Component);var TabelaLivros=/*#__PURE__*/function(_Component2){_inherits(TabelaLivros,_Component2);var _super2=_createSuper(TabelaLivros);function TabelaLivros(){_classCallCheck(this,TabelaLivros);return _super2.apply(this,arguments);}_createClass(TabelaLivros,[{key:\"render\",value:function render(){var livros=this.props.lista.map(function(livro){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:livro.titulo}),/*#__PURE__*/_jsx(\"td\",{children:livro.autor.nome}),/*#__PURE__*/_jsx(\"td\",{children:livro.preco})]},livro.id);});return/*#__PURE__*/_jsxs(\"table\",{className:\"pure-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Titulo\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Autor\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Preco\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:livros})]});}}]);return TabelaLivros;}(Component);var LivroAdmin=/*#__PURE__*/function(_Component3){_inherits(LivroAdmin,_Component3);var _super3=_createSuper(LivroAdmin);function LivroAdmin(props){var _this2;_classCallCheck(this,LivroAdmin);_this2=_super3.call(this,props);_this2.state={lista:[],autores:[]};return _this2;}_createClass(LivroAdmin,[{key:\"componentDidMount\",value:function componentDidMount(){$.ajax({url:\"https://cdc-react.herokuapp.com/api/livros\",dataType:'json',success:function(data){this.setState({lista:data});}.bind(this)});$.ajax({url:\"https://cdc-react.herokuapp.com/api/autores\",dataType:'json',success:function(data){console.log(data);this.setState({autores:data});}.bind(this)});PubSub.subscribe('atualiza-lista-livros',function(topicName,lista){this.setState({lista:lista});}.bind(this));}},{key:\"render\",value:function render(){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"header\",children:/*#__PURE__*/_jsx(\"h1\",{children:\"Cadastro de Livros\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"content\",id:\"content\",children:[/*#__PURE__*/_jsx(FormularioLivro,{autores:this.state.autores}),/*#__PURE__*/_jsx(TabelaLivros,{lista:this.state.lista})]})]});}}]);return LivroAdmin;}(Component);export{LivroAdmin as default};","map":{"version":3,"sources":["/home/joaohgs/Documents/ProjetosReact/cdc-admin/src/components/Livros.js"],"names":["$","InputCustomizado","React","Component","PubSub","TratadorErros","FormularioLivro","props","state","titulo","preco","autorId","setTitulo","bind","setPreco","setAutorId","handleLivroSubmit","e","setState","target","value","preventDefault","trim","ajax","url","contentType","dataType","type","data","JSON","stringify","success","novaListagem","publish","error","resposta","status","publicaErros","responseJSON","beforeSend","autores","map","autor","id","nome","TabelaLivros","livros","lista","livro","LivroAdmin","console","log","subscribe","topicName"],"mappings":"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","sourcesContent":["import $ from \"jquery\";\nimport InputCustomizado from \"./InputCustomizado\"\nimport React, { Component } from 'react';\nimport PubSub from 'pubsub-js';\nimport TratadorErros from './TratadorErros'\n\nclass FormularioLivro extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {titulo: '', preco: '', autorId: ''};\n    this.setTitulo = this.setTitulo.bind(this);\n    this.setPreco = this.setPreco.bind(this);\n    this.setAutorId = this.setAutorId.bind(this);   \n    this.handleLivroSubmit = this.handleLivroSubmit.bind(this);\n  }\n\n  setTitulo(e) {\n    this.setState({titulo: e.target.value});\n  }\n\n  setPreco(e) {\n    this.setState({preco: e.target.value});\n  }\n\n  setAutorId(e) {\n    this.setState({autorId: e.target.value});\n  }\n\n\n  handleLivroSubmit(e) {\n    e.preventDefault();\n    var titulo = this.state.titulo.trim();\n    var preco = this.state.preco.trim();\n    var autorId = this.state.autorId;\n\n    $.ajax({\n      url: 'https://cdc-react.herokuapp.com/api/livros',\n      contentType: 'application/json',\n      dataType: 'json',\n      type: 'POST',\n      data: JSON.stringify({titulo:titulo,preco:preco,autorId:autorId}),\n      success: function(novaListagem) {\n          PubSub.publish( 'atualiza-lista-livros',novaListagem);            \n          this.setState({titulo:'',preco:'',autorId:''});\n      },\n      error: function(resposta){\n        if(resposta.status === 400){\n          new TratadorErros().publicaErros(resposta.responseJSON);\n        }\n      },\n      beforeSend: function(){\n        PubSub.publish(\"limpa-erros\",{});\n      }            \n    });  \n\n    this.setState({titulo: '', preco: '', autorId: ''});\n  }\n\n  render() {\n    var autores = this.props.autores.map(function(autor){\n      return <option key={autor.id} value={autor.id}>{autor.nome}</option>;\n    });\n    return (\n      <div className=\"autorForm\">\n        <form className=\"pure-form pure-form-aligned\" onSubmit={this.handleLivroSubmit}>\n          <InputCustomizado id=\"titulo\" name=\"titulo\" label=\"Titulo: \" type=\"text\" value={this.state.titulo} placeholder=\"Titulo do livro\" onChange={this.setTitulo} />\n          <InputCustomizado id=\"preco\" name=\"preco\" label=\"Preco: \" type=\"decimal\" value={this.state.preco} placeholder=\"Preço do livro\" onChange={this.setPreco} />\n          <div className=\"pure-controls\">\n            <select value={this.state.autorId} name=\"autorId\" onChange={this.setAutorId}>\n              <option value=\"\">Selecione</option>\n              {autores}\n            </select>\n          </div>\n          <div className=\"pure-control-group\">                                  \n            <label></label> \n            <button type=\"submit\" className=\"pure-button pure-button-primary\">Gravar</button>                                    \n          </div>\n        </form>\n      </div>\n    );\n  }\n} \n\nclass TabelaLivros extends Component {\n\n  render() {\n    var livros = this.props.lista.map(function(livro){\n      return(\n          <tr key={livro.id}>\n            <td>{livro.titulo}</td>\n            <td>{livro.autor.nome}</td>\n            <td>{livro.preco}</td>\n          </tr>\n        );\n      });\n    return(\n      <table className=\"pure-table\">\n        <thead>\n          <tr>\n            <th>Titulo</th>\n            <th>Autor</th>\n            <th>Preco</th>\n          </tr>\n        </thead>\n        <tbody>\n          {livros}\n        </tbody>\n      </table>\n    );\n  }\n}\n\nexport default class LivroAdmin extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {lista : [],autores:[]};\n  }\n\n  componentDidMount() {\n    $.ajax({\n      url: \"https://cdc-react.herokuapp.com/api/livros\",\n      dataType: 'json',\n      success: function(data) {\n        this.setState({lista: data});\n      }.bind(this)\n    });\n\n    $.ajax({\n      url: \"https://cdc-react.herokuapp.com/api/autores\",\n      dataType: 'json',\n      success: function(data) {\n        console.log(data);\n        this.setState({autores: data});\n      }.bind(this)\n    });\n\n    PubSub.subscribe('atualiza-lista-livros', function(topicName,lista){\n      this.setState({lista:lista});\n    }.bind(this));\n  }\n\n  render() {\n    return(\n      <div>\n        <div className=\"header\">\n          <h1>Cadastro de Livros</h1>\n        </div>\n        <div className=\"content\" id=\"content\">\n          <FormularioLivro autores={this.state.autores}/>\n          <TabelaLivros lista={this.state.lista}/>\n        </div>\n      </div>\n    );\n  }\n}"]},"metadata":{},"sourceType":"module"}